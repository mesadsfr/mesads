{% extends "./base.html" %}
{% load str_to_date %}
{% block main %}
  <nav role="navigation" class="fr-breadcrumb" aria-label="vous √™tes ici :">
    <button class="fr-breadcrumb__button"
            aria-expanded="false"
            aria-controls="breadcrumb-1">Voir le fil d'Ariane</button>
    <div class="fr-collapse" id="breadcrumb-1">
      <ol class="fr-breadcrumb__list">
        <li>
          <a class="fr-breadcrumb__link" href="{% url 'app.ads-manager.index' %}">Gestion des ADS</a>
        </li>
        <li>
          <a class="fr-breadcrumb__link"
             href="{% url 'app.ads-manager.detail' manager_id=ads_manager.id %}">{{ ads_manager.content_object.display_text|capfirst }}</a>
        </li>
        <li>
          <a class="fr-breadcrumb__link"
             href="{% url 'app.waiting-list.list' manager_id=ads_manager.id %}">Liste d'attente</a>
        </li>
        <li>
          {% if ads %}
            <a class="fr-breadcrumb__link" aria-current="page">Entr√©e {{ object.number }} de la liste d'attente</a>
          {% else %}
            <a class="fr-breadcrumb__link" aria-current="page">Enregistrement d'une nouvelle entr√©e dans la liste d'attente</a>
          {% endif %}
        </li>
      </ol>
    </div>
  </nav>
  {% if object %}
    <p>
      üï∞Ô∏è&nbsp;<a class="fr-link fr-icon-arrow-right-line fr-link--icon-right"
   href="{% url 'app.waiting-list.history' manager_id=ads_manager.id waiting_list_id=object.id %}">Voir l'historique des modifications</a>
    </p>
  {% endif %}
  {% if object %}
    <div class="fr-notice fr-notice--info fr-mb-3w">
      <div class="fr-container">
        <div class="fr-notice__body">
          <p>
            <span class="fr-notice__title">Pour modifier les informations de cette demande,</span>
            <span class="fr-notice__desc">√©ditez les champs du formulaire et cliquez sur "Valider" en bas de cette page.</span>
          </p>
        </div>
      </div>
    </div>
  {% else %}
    <div class="fr-callout fr-icon-information-line">
      <h3 class="fr-callout__title">Rappel de la r√©glementation</h3>
      <ul class="fr-callout__text">
        <li>
          <a href="https://www.legifrance.gouv.fr/codes/article_lc/LEGIARTI000033745452?idSecParent=LEGISCTA000023083937"
             target="_blank">Article L3121-1-2 du code des transports</a> : Le titulaire exploite personnellement l'autorisation de stationnement mentionn√©e √† <a href="https://www.legifrance.gouv.fr/codes/article_lc/LEGIARTI000029532082"
    target="_blank">l'article L. 3121-1</a>.
        </li>
        <li>
          <a href="https://www.legifrance.gouv.fr/codes/article_lc/LEGIARTI000031971928"
             target="_blank">Article R3121-13 du code des transports</a> : "[‚Ä¶] cessent de figurer sur la liste d'attente d'une zone g√©ographique :
          <ul>
            <li>les demandes form√©es par un candidat qui figure d√©j√† sur une autre liste d'attente ;</li>
            <li>
              les demandes qui ne sont pas renouvel√©es, par tout moyen permettant d'en accuser r√©ception, avant la date anniversaire de l'inscription initiale ;
            </li>
            <li>
              les demandes form√©es par un candidat qui ne dispose pas de la carte professionnelle, en cours de validit√©, pr√©vue √† l'article <a href="https://www.legifrance.gouv.fr/codes/article_lc/LEGIARTI000023083909"
    target="_blank">L. 3121-10</a>.
            </li>
            <li>
              Les demandes form√©es par un candidat qui d√©tient d√©j√†, √† la date de sa demande, une autorisation de stationnement."
            </li>
          </ul>
        </li>
      </ul>
    </div>
  {% endif %}
  <form method="post" enctype="multipart/form-data">
    <!-- Non-field errors -->
    {% if form.non_field_errors %}
      <div class="fr-input-group fr-input-group--error">
        {% for error in form.non_field_errors %}<p class="fr-error-text">{{ error }}</p>{% endfor %}
      </div>
    {% endif %}
    {% csrf_token %}
    <fieldset class="fr-mb-3w fr-pt-1w fr-pb-2w fr-pl-2w fr-pr-2w border border-neutral-300">
      <legend class="text-2xl font-semibold">Informations sur la demande</legend>
      <!-- number -->
      {% include "form_fields/string.html" with field=form.number field_errors=form.errors.number required=form.fields.number.required %}
      <!-- status -->
      {% include "form_fields/select.html" with field=form.status field_errors=form.errors.status required=form.fields.status.required %}
      <!-- initial_request_date -->
      {% include "form_fields/date.html" with field=form.initial_request_date field_errors=form.errors.initial_request_date required=form.fields.initial_request_date.required %}
      <!-- last_update_date -->
      {% include "form_fields/date.html" with field=form.last_renew_date field_errors=form.errors.last_renew_date required=form.fields.last_renew_date.required %}
      <!-- end_validity_date -->
      {% include "form_fields/date.html" with field=form.end_validity_date field_errors=form.errors.end_validity_date required=form.fields.end_validity_date.required %}
      <!-- used_das_two_years -->
      {% include "form_fields/select.html" with field=form.used_ads_two_years field_errors=form.errors.used_ads_two_years required=form.fields.used_ads_two_years.required %}
      <!-- comment -->
      {% include "form_fields/textarea.html" with field=form.comment field_errors=form.errors.comment required=form.fields.comment.required %}
    </fieldset>
    <fieldset class="fr-mb-3w fr-pt-1w fr-pb-2w fr-pl-2w fr-pr-2w border border-neutral-300">
      <legend class="text-2xl font-semibold">Informations sur le demandeur</legend>
      <!-- name -->
      {% include "form_fields/string.html" with field=form.name field_errors=form.errors.name required=form.fields.name.required %}
      <!-- license_number -->
      {% include "form_fields/string.html" with field=form.license_number field_errors=form.errors.license_number required=form.fields.license_number.required %}
      <!-- phone_number -->
      {% include "form_fields/string.html" with field=form.phone_number field_errors=form.errors.phone_number required=form.fields.phone_number.required %}
      <!-- email -->
      {% include "form_fields/string.html" with field=form.email field_errors=form.errors.email required=form.fields.email.required %}
      <!-- address -->
      {% include "form_fields/string.html" with field=form.address field_errors=form.errors.address required=form.fields.address.required %}
    </fieldset>
    {% if form.certify %}
      <fieldset class="fr-mb-3w fr-pt-1w fr-pb-2w fr-pl-2w fr-pr-2w border border-neutral-300">
        <legend class="text-2xl font-semibold">Mise √† jour des informations</legend>
        {% include "form_fields/bool.html" with field=form.certify field_errors=form.errors.certify required=form.fields.certify.required %}
      </fieldset>
    {% endif %}
    <!-- Submit buttons -->
    <div class="fr-input-group">
      {% if object %}
        <button type="submit" class="fr-btn">Valider les modifications de la demande</button>
      {% else %}
        <button type="submit" class="fr-btn">Enregistrer la demande</button>
      {% endif %}
    </div>
  </form>
{% endblock main %}
{% comment %} WAITING_LIST_STATUS = {
"valid": {
"display_text": "Demande valide",
"display_help_text": "Cette entr√©e de la liste d'attente remplit toutes les conditions pour avoir une ADS.",
},
"incomplete": {
"display_text": "Demande incompl√®te",
"display_help_text": "Des informations manquent pour que cette entr√©e de la liste d'attente puisse √™tre trait√©e.",
},
} {% endcomment %}
