{% extends "base.html" %}
{% block body %}
  {% if not request.user.is_authenticated %}

    <div class="homepage-section">
      <div class="fr-container">
        <div class="fr-grid-row fr-grid-row--gutters fr-grid-row--middle">
          <div class="fr-col-12 fr-col-lg-8">
              <h1 class="fr-mt-5w">MesADS, l‚Äôoutil de r√©f√©rence du secteur taxi</h1>

              <p class="fr-text--lead ">
                MesADS simplifie la <strong>gestion administrative des taxis</strong> pour tous les acteurs du secteur. 
                Que vous soyez <strong>pr√©fecture, mairie, chauffeur en exercice ou en formation</strong>, 
                notre plateforme centralise l'ensemble des d√©marches administratives li√©es aux taxis. Un outil de r√©f√©rence qui 
                <strong>connecte les administrations et les professionnels</strong> pour une gestion fluide et efficace de toutes 
                vos <strong>Autorisations De Stationnement (ADS)</strong>.
              </p>

              <div class="fr-my-6v">
                <a class="fr-btn fr-mr-4v" href="{% url 'login' %}">Se connecter</a>
                <a class="fr-btn fr-btn--secondary" href="{% url 'pre_register' %}">S'inscrire</a>
              </div>

              <div class="fr-notice fr-notice--info fr-mt-3v">
                <div class="fr-notice__body">
                  <p class="fr-notice__title fr-px-2v">
                    Connexion requise uniquement pour : g√©rer les ADS (mairies/pr√©fectures), s'inscrire sur liste d'attente (futurs chauffeurs) 
                    ou enregistrer un taxi relais ‚Äî Acc√®s libre √† toutes les autres fonctionnalit√©s.
                  </p>
                </div>
              </div>
          </div>

          <div class="fr-col-12 fr-col-lg-4">
            <img 
              class="fr-ml-6v"
              width="60%"
              height="60%"
              alt=""
              src="../images/logo_homepage.png"
            />
          </div>
        </div>
      </div>
    </div>

    <div class="homepage-section background-light-grey">
      <div class="fr-container">
        <h2 class="text-center">Les services en libre acc√®s</h2>
        <div class="fr-grid-row fr-grid-row--gutters">
          <div class="fr-col-6">
            <div class="fr-tile fr-enlarge-link" id="tile-reglementation">
              <div class="fr-tile__body">
                <div class="fr-tile__content">
                  <h3 class="fr-tile__title">
                    <a href="{% url 'app.reglementation' %}">R√©glementation</a>
                  </h3>
                  <p class="fr-tile__detail">Acc√©der aux informations officielles sur la r√©glementation des taxis.</p>
                </div>
              </div>
              <div class="fr-tile__header">
                <div class="fr-tile__pictogram">
                  <img src="../images/homepage/icone_reglementation.png" width="80px">
                </div>
              </div>
            </div>
          </div>
          <div class="fr-col-6">
            <div class="fr-tile fr-enlarge-link" id="tile-repertoire">
              <div class="fr-tile__body">
                <div class="fr-tile__content">
                  <h3 class="fr-tile__title">
                    <a href="{% url 'vehicules-relais.index' %}">R√©pertoires des taxis relais</a>
                  </h3>
                  <p class="fr-tile__detail">Consulter la liste compl√®te des taxis relais disponibles.</p>
                </div>
              </div>
              <div class="fr-tile__header">
                <div class="fr-tile__pictogram">
                  <img src="../images/homepage/icone_repertoire.png" width="80px">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


  {% else %}

  {% if administrateur_ads %}
    
    <div class="homepage-section">
      <div class="fr-container">
        <div class="fr-grid-row fr-grid-row--gutters">
          <div class="fr-col-12 fr-col-lg-8">
            <h1>Espace de la {{ ads_manager_administrator.prefecture.display_text|capfirst }}</h1>

            <p>
              <a
                class="fr-link fr-icon-arrow-right-line fr-link--icon-right"
                href="{% url 'app.ads-manager-admin.requests' prefecture_id=ads_manager_administrator.prefecture.id %}"
              >
                <span class="fr-icon-feedback-line" aria-hidden="true"></span>
                Demande d'acc√®s des gestionnaires rattach√©s √† votre Pr√©fecture
              </a>
            </p>
            <p>
              <a
                class="fr-link fr-icon-arrow-right-line fr-link--icon-right"
                href="{% url 'app.ads-manager-admin.administrations' prefecture_id=ads_manager_administrator.prefecture.id %}"
              >
                <span class="fr-icon-survey-line" aria-hidden="true"></span>
                Donn√©es li√©es aux ADS de votre Pr√©fecture
              </a>
            </p>
            <p>
              <a
                class="fr-link fr-icon-arrow-right-line fr-link--icon-right"
                href="{% url 'app.ads-manager-admin.vehicules_relais' prefecture_id=ads_manager_administrator.prefecture.id %}"
              >
                <span class="fr-icon-file-pdf-line" aria-hidden="true"></span>
                Donn√©es li√©es aux r√©pertoires des taxis relais de votre pr√©fecture
              </a>
            </p>
            <p>
              <a
                class="fr-link fr-icon-arrow-right-line fr-link--icon-right"
                href="{% url 'app.ads-manager-admin.updates' prefecture_id=ads_manager_administrator.prefecture.id %}"
              >
                <span aria-hidden="true" class="fr-icon-eye-line"></span>
                Modifications effectu√©es par les gestionnaires rattach√©s √† votre Pr√©fecture
              </a>
            </p>
          </div>

          <div class="fr-col-12 fr-col-lg-4">
            <img 
              class="fr-ml-6v fr-mt-6v"
              width="60%"
              height="60%"
              alt=""
              src="../images/logo_homepage.png"
            />
          </div>
        </div>
      </div>
    </div>

  {% elif manager_ads %}
    <div class="homepage-section">
      <div class="fr-container">
        <div class="fr-grid-row fr-grid-row--gutters">
          <div class="fr-col-12 fr-col-lg-8">
              <h1 class="fr-mt-5w">Vos administrations en gestion</h1>

              <p class="fr-text--lead ">
                Cette page inventorie les administrations pour lesquelles vous avez demand√© √† g√©rer les ADS (licences de taxi). Vous pouvez demander √† g√©rer les ADS pour une nouvelle administration.
              </p>

              <div class="fr-table fr-table--lg fr-table--no-scroll fr-table--no-caption">
                <div class="fr-table__wrapper">
                  <div class="fr-table__container">
                    <div class="fr-table__content">
                      <table>
                        <caption>Administrations en gestion</caption>
                        <thead>
                          <tr>
                            <th>Administration</th>
                            <th>Nombre d'ADS</th>
                            <th>Consulter / Modifier</th>
                          </tr>
                        </thead>
                        <tbody>
                          {% for requete in requetes_gestionnaires %}
                            <tr>
                              <td>{{ requete.ads_manager.content_object.display_text|capfirst }}</td>
                              <td>
                                {% if requete.ads_count %}
                                  {{ requete.ads_count }}
                                {% elif requete.ads_manager.no_ads_declared %}
                                  <small>Ne g√®re aucune ADS</small>
                                {% elif requete.ads_manager.epci_delegate %}
                                  <small>ADS g√©r√©es par l'EPCI
                                    <br />
                                    <i>{{ requete.ads_manager.epci_delegate }}</i></small>
                                {% else %}
                                  -
                                {% endif %}
                                {% if requete.complete_updates_count %}
                                  <p class="fr-text--xs">(dont {{ requete.complete_updates_count }} avec toutes les informations)</p>
                                {% elif requete.ads_count %}
                                  <p class="fr-text--xs text-red-500">(√† v√©rifier)</p>
                                {% endif %}
                              </td>
                              <td>
                                {% if requete.accepted is None %}
                                  ‚è± En attente de validation par la pr√©fecture
                                {% elif requete.accepted is False %}
                                  üö´ Demande refus√©e
                                {% elif requete.accepted is True %}
                                  <a class="fr-btn fr-btn--primary"
                                    href="{% url 'app.ads-manager.detail' manager_id=requete.ads_manager.id %}">G√©rez les ADS</a>
                                {% endif %}
                              </td>
                            </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>

              <div class="fr-my-6v">
                <a class="fr-btn fr-btn--secondary" href="{% url 'app.ads-manager.demande_gestion_ads' %}">Demander √† g√©rer une autre administration</a>
              </div>
          </div>

          <div class="fr-col-12 fr-col-lg-4">
            <img 
              class="fr-ml-6v fr-mt-6v"
              width="60%"
              height="60%"
              alt=""
              src="../images/logo_homepage.png"
            />
          </div>
        </div>
      </div>
    </div>

  {% elif proprietaire_vehicule_relais %}
    <div class="homepage-section">
      <div class="fr-container">
        <div class="fr-grid-row fr-grid-row--gutters">
          <div class="fr-col-12 fr-col-lg-8">
            <h1 class="fr-mt-5w">MesADS, l'outil de r√©f√©rence du secteur taxi</h1>

            <p>
              MesADS simplifie la <strong>gestion administrative des taxis.</strong> Un outil de r√©f√©rence qui 
              <strong>connecte les administrations et les professionnels</strong> pour une gestion 
              fluide et efficace de toutes vos <strong>autorisations.</strong>
            </p>
              
          </div>

          <div class="fr-col-12 fr-col-lg-4">
            <img 
              class="fr-ml-6v fr-mt-6v"
              width="60%"
              height="60%"
              alt=""
              src="../images/logo_proprietaire.png"
            />
          </div>
        </div>
      </div>
    </div>

    <div class="homepage-section background-light-grey">
      <div class="fr-container">
        <h2 class="text-center">Les services pour les professionnels du taxi</h2>
        <div class="fr-grid-row fr-grid-row--gutters">
          <div class="fr-col-6">
            <div class="fr-tile fr-enlarge-link" id="tile-repertoire">
              <div class="fr-tile__body">
                <div class="fr-tile__content">
                  <h3 class="fr-tile__title">
                    <a href="{% url 'vehicules-relais.index' %}">Mettre en circulation ou recourir √† un taxis relais</a>
                  </h3>
                  <p class="fr-tile__detail">Acc√©der aux repertoires.</p>
                </div>
              </div>
              <div class="fr-tile__header">
                <div class="fr-tile__pictogram">
                  <img src="../images/homepage/icone_repertoire.png" width="80px" />
                </div>
              </div>
            </div>
          </div>

          <div class="fr-col-6">
            <div class="fr-tile fr-enlarge-link" id="tile-reglementation">
              <div class="fr-tile__body">
                <div class="fr-tile__content">
                  <h3 class="fr-tile__title">
                    <a href="{% url 'app.reglementation' %}">Acc√©der aux informations officielles sur la r√©glementation des taxis</a>
                  </h3>
                  <p class="fr-tile__detail">Comprendre la r√©glementation.</p>
                </div>
              </div>
              <div class="fr-tile__header">
                <div class="fr-tile__pictogram">
                  <img src="../images/homepage/icone_reglementation.png" width="80px" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  {% endif %}



  {% endif %}
    <div class="homepage-section">
      <div class="fr-container text-center">
        <h2 class="blue-france text-left">Une solution qui fait ses preuves</h2>
        <div class="fr-grid-row fr-grid-row--gutters fr-grid-row--middle fr-grid-row--center fr-mb-4v">
          <div class="fr-col-4">
            <div class="text-center blue-france fr-display--xs fr-mb-2v">
              35%
            </div>
            <div class="text-center">
              de collectivit√©s engag√©es dans les d√©partements participants
            </div>
          </div>
          <div class="fr-col-4">
            <div class="text-center blue-france fr-display--xs fr-mb-2v">
              29
            </div>
            <div class="text-center">
              d√©partements d√©ploy√©s
            </div>
          </div>
          <div class="fr-col-4">
            <div class="text-center blue-france fr-display--xs fr-mb-2v">
              92,2%
            </div>
            <div class="text-center">
              de taux de fiabilit√© des donn√©es
            </div>
          </div>
        </div>
        <a class="fr-link" href="{% url 'app.stats' %}">Voir plus de statistiques</a>
      </div>
    </div>

    <div class="homepage-section background-light-grey">
      <div class="fr-container">
        <h2>Notre newsletter</h2>
        <div class="fr-grid-row fr-grid-row--gutters justify-between">
          <div class="fr-col-5">
            <p>
              Abonnez-vous pour recevoir des nouvelles tous les trimestres de MesADS
            </p>

            <a class="fr-btn" href="/">Demander une d√©monstration</a>
          </div>
          <div class="fr-col-5">
            <p>
              Retrouver nos anciennes infolettres
            </p>
            <p>
              <a class="fr-link" href="/">
                Infolettre n¬∞2 - Avril 2023
              </a>
            </p>
            <p>
              <a class="fr-link" href="/">
                Infolettre n¬∞1 - Janvier 2023
              </a>
            </p>
          </div>
          </div>
        </div>
      </div>
    </div>

    <div class="homepage-section">
      <div class="fr-container text-center fr-pt-3v">
        <a class="fr-btn fr-btn--secondary" href="mailto:{{ MESADS_CONTACT_EMAIL }}">Nous contacter</a>
      </div>
    </div>
    
{% endblock body %}
